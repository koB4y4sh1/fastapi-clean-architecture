# プロジェクト構成ドキュメント

## 1. 概要

本プロジェクトは **FastAPI** を用い、クリーンアーキテクチャの原則に則ったディレクトリ構成を採用しています。  
各層が明確に分離されており、拡張性・保守性に優れた設計です。

---

## 2. `/src` ディレクトリ構成と役割

| ディレクトリ名         | 役割・内容の説明                                                                 |
|-----------------------|-------------------------------------------------------------------------------|
| `adapter/`            | DBや外部APIなどの具体的な接続・実装。APIルータやリポジトリの実装など。           |
| `application/`        | ユースケース層。ドメインモデルとリポジトリを組み合わせたビジネスロジック。       |
| `domain/`             | ドメイン層。モデルやリポジトリの抽象定義など、ビジネスルールの中心。             |
| `interface/`          | APIやサービスのインターフェース。APIサービスや外部I/Fの橋渡し。                 |
| `schema/`             | FastAPIで使用するPydanticモデル。APIのリクエスト・レスポンス定義。               |
| `utils/`              | プロジェクト全体で使う共通ユーティリティ関数やモジュール。                       |

---

## 3. 層ごとの役割詳細

### 3.1 `adapter/`
- 外部システムやDBとの接続・実装を担当
- 例：DBリポジトリ実装、APIルータ
- `domain`や`domain`の抽象インターフェースを実装

### 3.2 `application/`
- ユースケース層
- ドメインモデルとリポジトリを組み合わせてビジネスロジックを実装
- 複数のドメインを跨る業務処理もここに記述

### 3.3 `domain/`
- ドメイン層
- モデルやリポジトリの抽象定義
- ビジネスルールの中心となる部分

### 3.4 `interface/`
- APIやサービスのインターフェース
- APIサービスや外部I/Fの橋渡し

### 3.5 `schema/`
- FastAPIのRequest/Responseの型定義
- Pydanticを使いバリデーションやデータシリアライズを担う

### 3.6 `utils/`
- プロジェクト全体で使う共通関数やユーティリティ
- ロギングや例外処理、セキュリティ関連など

---

## 4. クリーンアーキテクチャ思想との対応

- **依存関係逆転の原則**  
  ドメイン層（`domain`）が最も内側にあり、外部（`adapter`や`interface`）は内側に依存します。
- **ビジネスロジックの独立性**  
  `application`や`domain`は外部技術やフレームワークに依存しません。
- **テスト容易性**  
  各層が分離されているため、ユニットテスト・結合テストが容易です。

---

## 5. 運用上の注意

- 各層の責務を明確にし、役割を混在させないこと
- `utils/`は肥大化しやすいので目的別に細分化して管理推奨
- APIバージョニングや依存注入の設計も拡張性を意識して実装

---

## 6. 今後の拡張例

- DI（依存性注入）コンテナの導入
- テストコードのディレクトリ分割（ユニット・結合・E2E）
- CI/CDパイプラインの構築
- 認証・認可機能のレイヤリング

---

## 7. まとめ

本構成はクリーンアーキテクチャの考え方に沿いながらも、現場で理解しやすく、実装しやすい命名と役割分離を意識したものです。  
チームの成長やシステム拡張にも柔軟に対応可能です。
